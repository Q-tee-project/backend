# ì˜ì–´ ë¬¸ì œ ì¬ìƒì„± API ê°€ì´ë“œ (v2.0)

ì´ ë¬¸ì„œëŠ” ì˜ì–´ ë¬¸ì œ ì¬ìƒì„± APIì˜ ìµœì‹  ì‚¬ì–‘ì„ ì„¤ëª…í•©ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë¬¸ì œ ì¬ìƒì„± ê¸°ëŠ¥ì„ êµ¬í˜„í•  ë•Œ ì´ ë¬¸ì„œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‚¼ì•„ì£¼ì„¸ìš”.

## âœ¨ ì£¼ìš” ë³€ê²½ì‚¬í•­ (v2.0)

- **ë°ì´í„° ê¸°ë°˜ ì¬ìƒì„± API ì¶”ê°€**: DBì— ì €ì¥ë˜ì§€ ì•Šì€ ë¬¸ì œ(ì˜ˆ: ìƒì„± ë¯¸ë¦¬ë³´ê¸°)ë„ ì¬ìƒì„±í•  ìˆ˜ ìˆëŠ” ì—”ë“œí¬ì¸íŠ¸ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.
- **ì§€ë¬¸ ë° ì—°ê³„ ë¬¸ì œ ë™ì‹œ ì¬ìƒì„±**: ì§€ë¬¸ê³¼ ì´ì— ì—°ê´€ëœ ëª¨ë“  ë¬¸ì œë¥¼ í•œ ë²ˆì˜ ìš”ì²­ìœ¼ë¡œ ì¬ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì´ ëª…í™•í•´ì¡ŒìŠµë‹ˆë‹¤.

---

## ğŸ“ API ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½

| Method | ê²½ë¡œ                                                              | ì„¤ëª…                                                 |
|--------|-------------------------------------------------------------------|------------------------------------------------------|
| `GET`  | `/worksheets/{worksheet_id}/questions/{question_id}/regeneration-info` | ì¬ìƒì„± í¼ êµ¬ì„±ì„ ìœ„í•œ í˜„ì¬ ë¬¸ì œ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.   |
| `POST` | `/worksheets/{worksheet_id}/questions/{question_id}/regenerate`      | **DBì— ì €ì¥ëœ** íŠ¹ì • ë¬¸ì œë¥¼ ì¬ìƒì„±í•©ë‹ˆë‹¤.            |
| `POST` | `/questions/regenerate-data`                                      | **ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ** ë¬¸ì œë¥¼ ì¬ìƒì„±í•©ë‹ˆë‹¤. (DB ì €ì¥ X) |

---

## âš™ï¸ API ìƒì„¸ ì„¤ëª…

### 1. ì¬ìƒì„± ì •ë³´ ì¡°íšŒ

- **Method**: `GET`
- **Endpoint**: `/worksheets/{worksheet_id}/questions/{question_id}/regeneration-info`
- **ëª©ì **: ë¬¸ì œ ì¬ìƒì„± ëª¨ë‹¬(í¼)ì„ ë„ìš°ê¸° ì „ì—, í•´ë‹¹ ë¬¸ì œì˜ í˜„ì¬ ìƒíƒœì™€ í•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ì •ë³´ë¥¼ ë°±ì—”ë“œë¡œë¶€í„° ê°€ì ¸ì˜µë‹ˆë‹¤.
- **ì‘ë‹µ ì˜ˆì‹œ**:
  ```json
  {
    "question": {
      "id": 5,
      "question_type": "ê°ê´€ì‹",
      "question_subject": "ë…í•´",
      "question_detail_type": "ì œëª© ë° ìš”ì§€ ì¶”ë¡ ",
      "question_difficulty": "ìƒ",
      "passage_id": 2
    },
    "worksheet": {
      "school_level": "ì¤‘í•™êµ",
      "grade": 1,
      "problem_type": "í˜¼í•©í˜•"
    },
    "has_passage": true,
    "related_questions": [
      {"id": 6, "text": "ë‹¤ìŒ ê¸€ì˜ ë‚´ìš©ê³¼ ì¼ì¹˜í•˜ëŠ” ê²ƒì€?"},
      {"id": 7, "text": "ë¹ˆ ì¹¸ì— ë“¤ì–´ê°ˆ ë§ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?"}
    ]
  }
  ```

### 2. ë¬¸ì œ ì¬ìƒì„± (DB ê¸°ë°˜)

- **Method**: `POST`
- **Endpoint**: `/worksheets/{worksheet_id}/questions/{question_id}/regenerate`
- **ëª©ì **: ì´ë¯¸ ìƒì„±ë˜ì–´ DBì— ì €ì¥ëœ ë¬¸ì œë¥¼ ì‚¬ìš©ìì˜ í”¼ë“œë°±ì— ë”°ë¼ ì¬ìƒì„±í•˜ê³ , ê²°ê³¼ë¥¼ ë‹¤ì‹œ DBì— ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
- **Request Body**: `QuestionRegenerationRequest` ìŠ¤í‚¤ë§ˆ (ì•„ë˜ ìš”ì²­ ì˜ˆì‹œ ì°¸ê³ )

### 3. ë¬¸ì œ ì¬ìƒì„± (ë°ì´í„° ê¸°ë°˜)

- **Method**: `POST`
- **Endpoint**: `/questions/regenerate-data`
- **ëª©ì **: ì•„ì§ DBì— ì €ì¥ë˜ì§€ ì•Šì€ ë¬¸ì œ ë°ì´í„°(ì˜ˆ: ë¬¸ì œ ìƒì„± ë‹¨ê³„ì˜ ë¯¸ë¦¬ë³´ê¸°)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¬ìƒì„±í•©ë‹ˆë‹¤. ì´ APIëŠ” DBì— ì•„ë¬´ëŸ° ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë©°, ìˆœìˆ˜í•˜ê²Œ ë°ì´í„°ë§Œ ë³€í™˜í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
- **Request Body**: `QuestionDataRegenerationRequest` ìŠ¤í‚¤ë§ˆ
  ```json
  {
    "question_data": { ... }, // ì¬ìƒì„±í•  ì›ë³¸ ë¬¸ì œ ë°ì´í„°
    "passage_data": { ... }, // (ì„ íƒ) ì›ë³¸ ì§€ë¬¸ ë°ì´í„°
    "regeneration_request": { ... } // QuestionRegenerationRequest ìŠ¤í‚¤ë§ˆ
  }
  ```

---

## ğŸ“‹ í•µì‹¬ ì‹œë‚˜ë¦¬ì˜¤ë³„ ìš”ì²­ ì˜ˆì‹œ

### `QuestionRegenerationRequest` ê³µí†µ êµ¬ì¡°

ëª¨ë“  ì¬ìƒì„± ìš”ì²­ì€ ì•„ë˜ êµ¬ì¡°ë¥¼ ë”°ë¥´ëŠ” `regeneration_request` ê°ì²´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

```json
{
  "feedback": "ë¬¸ì œ ìˆ˜ì • ìš”êµ¬ì‚¬í•­ (í•„ìˆ˜)",
  "worksheet_context": { "school_level": "ì¤‘í•™êµ", "grade": 1, "worksheet_type": "í˜¼í•©í˜•" },
  "current_question_type": "ê°ê´€ì‹",
  "current_subject": "ë…í•´",
  "current_detail_type": "ì œëª© ë° ìš”ì§€ ì¶”ë¡ ",
  "current_difficulty": "ìƒ",

  "keep_passage": true,
  "regenerate_related_questions": false,
  "keep_question_type": true,
  "keep_difficulty": true,
  "keep_subject": true,
  "keep_detail_type": true,

  "target_question_type": null,
  "target_difficulty": null,
  "target_subject": null,
  "target_detail_type": null,

  "additional_requirements": null
}
```

---

### ğŸ”¹ ì‹œë‚˜ë¦¬ì˜¤ 1: ë‚´ìš©ë§Œ ìˆ˜ì • (ê¸°ë³¸ ì¬ìƒì„±)

- **ìƒí™©**: ë¬¸ì œì˜ ë‹¤ë¥¸ ì¡°ê±´ì€ ëª¨ë‘ ìœ ì§€í•œ ì±„, í”¼ë“œë°±ì— ë”°ë¼ ë‚´ìš©ë§Œ ê°œì„ í•˜ê³  ì‹¶ì„ ë•Œ.
- **ìš”ì²­**:
  ```json
  {
    "feedback": "ë¬¸ì œê°€ ë„ˆë¬´ ì¥í™©í•©ë‹ˆë‹¤. ë” ê°„ê²°í•˜ê²Œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.",
    "worksheet_context": { ... },
    "current_question_type": "ê°ê´€ì‹",
    "current_subject": "ë¬¸ë²•",
    "current_detail_type": "ì‹œì œ",
    "current_difficulty": "ì¤‘"
  }
  ```

### ğŸ”¹ ì‹œë‚˜ë¦¬ì˜¤ 2: ë‚œì´ë„ ë³€ê²½

- **ìƒí™©**: ë¬¸ì œê°€ ë„ˆë¬´ ì–´ë µê±°ë‚˜ ì‰¬ì›Œì„œ ë‚œì´ë„ë¥¼ ì¡°ì ˆí•˜ê³  ì‹¶ì„ ë•Œ.
- **ìš”ì²­**:
  ```json
  {
    "feedback": "ë¬¸ì œê°€ ë„ˆë¬´ ì–´ë ¤ì›Œìš”. 'í•˜' ìˆ˜ì¤€ìœ¼ë¡œ ë‚®ì¶°ì£¼ì„¸ìš”.",
    "keep_difficulty": false,       // ë‚œì´ë„ ìœ ì§€ ì•ˆí•¨
    "target_difficulty": "í•˜",      // ëª©í‘œ ë‚œì´ë„ë¥¼ 'í•˜'ë¡œ ì„¤ì •
    "worksheet_context": { ... },
    "current_question_type": "ì„œìˆ í˜•",
    "current_subject": "ë…í•´",
    "current_detail_type": "ë‚´ìš© ìš”ì•½",
    "current_difficulty": "ìƒ"
  }
  ```

### â€¼ï¸ [ì¤‘ìš”] ì‹œë‚˜ë¦¬ì˜¤ 3: ì§€ë¬¸ê³¼ ëª¨ë“  ì—°ê³„ ë¬¸ì œ ë™ì‹œ ì¬ìƒì„±

- **ìƒí™©**: ì§€ë¬¸ì´ ë§ˆìŒì— ë“¤ì§€ ì•Šì•„, **ì§€ë¬¸ ìì²´ë¥¼ í¬í•¨í•œ ëª¨ë“  ê´€ë ¨ ë¬¸ì œë¥¼ í•œ ë²ˆì—** ìƒˆë¡œìš´ ë‚´ìš©ìœ¼ë¡œ ë°”ê¾¸ê³  ì‹¶ì„ ë•Œ.
- **í•µì‹¬ ì¡°ê±´**: `keep_passage`ë¥¼ `false`ë¡œ, `regenerate_related_questions`ë¥¼ `true`ë¡œ **ë°˜ë“œì‹œ í•¨ê»˜ ì„¤ì •**í•´ì•¼ í•©ë‹ˆë‹¤.
- **ìš”ì²­**:
  ```json
  {
    "feedback": "ì§€ë¬¸ì´ ë„ˆë¬´ ì§€ë£¨í•©ë‹ˆë‹¤. í¥ë¯¸ë¡œìš´ ê³¼í•™ ê¸°ì‚¬ë¡œ ë°”ê¿”ì£¼ì„¸ìš”.",
    "keep_passage": false,                  // â¬…ï¸ ì§€ë¬¸ì„ ìƒˆë¡œ ìƒì„±
    "regenerate_related_questions": true,   // â¬…ï¸ ì—°ê³„ëœ ë¬¸ì œë“¤ë„ ëª¨ë‘ ì¬ìƒì„±
    "worksheet_context": { ... },
    "current_question_type": "ê°ê´€ì‹",
    "current_subject": "ë…í•´",
    "current_detail_type": "ë‚´ìš© ì¼ì¹˜",
    "current_difficulty": "ì¤‘"
  }
  ```
- **ë™ì‘ ë°©ì‹**:
  1. ë°±ì—”ë“œëŠ” `keep_passage: false`ë¥¼ ë³´ê³  ìƒˆë¡œìš´ ì§€ë¬¸ì„ ìƒì„±í•©ë‹ˆë‹¤.
  2. `regenerate_related_questions: true`ë¥¼ í™•ì¸í•˜ê³ , ê¸°ì¡´ ì§€ë¬¸ê³¼ ì—°ê²°ëœ ëª¨ë“  ë¬¸ì œ(í˜„ì¬ ìš”ì²­í•œ ë¬¸ì œ í¬í•¨)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
  3. ê°ê°ì˜ ì—°ê³„ ë¬¸ì œì— ëŒ€í•´, **ìƒˆë¡œ ìƒì„±ëœ ì§€ë¬¸**ì— ë‚´ìš©ì´ ë§ë„ë¡ ìë™ìœ¼ë¡œ ì¬ìƒì„±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
  4. ìµœì¢…ì ìœ¼ë¡œ, ìƒˆë¡œ ë§Œë“¤ì–´ì§„ ì§€ë¬¸ 1ê°œì™€ ì—¬ëŸ¬ ê°œì˜ ìƒˆë¡œìš´ ë¬¸ì œë“¤ì„ ì‘ë‹µìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

---

## ğŸ“¤ ì‘ë‹µ ë°ì´í„° ìƒì„¸

### 1. ë‹¨ì¼ ë¬¸ì œ ì¬ìƒì„± ì„±ê³µ ì‹œ

- **íŠ¸ë¦¬ê±°**: ì‹œë‚˜ë¦¬ì˜¤ 1, 2 ë˜ëŠ” `regenerate_related_questions: false`ì¸ ê²½ìš°
- **ì‘ë‹µ ì˜ˆì‹œ**:
  ```json
  {
    "status": "success",
    "message": "ë¬¸ì œê°€ ì„±ê³µì ìœ¼ë¡œ ì¬ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
    "regenerated_question": {
      "id": 5,
      "question_text": "ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì§„ ë¬¸ì œ í…ìŠ¤íŠ¸...",
      "question_type": "ê°ê´€ì‹",
      "question_difficulty": "í•˜",
      ...
    },
    "regenerated_passage": null, // ì§€ë¬¸ì„ ë°”ê¾¸ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ null
    "regenerated_related_questions": null
  }
  ```

### 2. ì§€ë¬¸ê³¼ ì—°ê³„ ë¬¸ì œ ë™ì‹œ ì¬ìƒì„± ì„±ê³µ ì‹œ

- **íŠ¸ë¦¬ê±°**: ì‹œë‚˜ë¦¬ì˜¤ 3 (`keep_passage: false` AND `regenerate_related_questions: true`)
- **ì‘ë‹µ ì˜ˆì‹œ**:
  ```json
  {
    "status": "success",
    "message": "ì§€ë¬¸ê³¼ ì—°ê³„ëœ ë¬¸ì œë“¤ì´ ëª¨ë‘ ì„±ê³µì ìœ¼ë¡œ ì¬ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
    "regenerated_question": {
      "id": 5,
      "question_text": "ìƒˆ ì§€ë¬¸ì— ë§ëŠ” ì²« ë²ˆì§¸ ë¬¸ì œ...",
      ...
    },
    "regenerated_passage": {
      "passage_id": 2,
      "passage_content": "ìƒˆë¡œìš´ ì§€ë¬¸ ë‚´ìš©...",
      ...
    },
    "regenerated_related_questions": [
      {
        "id": 6,
        "question_text": "ìƒˆ ì§€ë¬¸ì— ë§ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì œ...",
        ...
      },
      {
        "id": 7,
        "question_text": "ìƒˆ ì§€ë¬¸ì— ë§ëŠ” ì„¸ ë²ˆì§¸ ë¬¸ì œ...",
        ...
      }
    ]
  }
  ```
- **í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**: ì´ ì‘ë‹µì„ ë°›ìœ¼ë©´, `regenerated_passage`ë¡œ ì§€ë¬¸ UIë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , `regenerated_question` ë° `regenerated_related_questions` ë°°ì—´ì— í¬í•¨ëœ ëª¨ë“  ë¬¸ì œë“¤ì„ ê¸°ì¡´ ë¬¸ì œ ì¹´ë“œ UIì™€ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤.

---

## ğŸ’¡ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê°€ì´ë“œ

- **ì§€ë¬¸ ì—°ê³„ ë¬¸ì œ ê²½ê³ **: `GET .../regeneration-info` ì‘ë‹µì— `related_questions`ê°€ ìˆìœ¼ë©´, "ì§€ë¬¸ì„ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ë¬¸ì œë„ ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤." ì™€ ê°™ì€ ì•ˆë‚´ë¥¼ í‘œì‹œí•´ì£¼ì„¸ìš”.
- **ë™ì‹œ ì¬ìƒì„± ì˜µì…˜ ì œê³µ**: ìœ„ ê²½ê³ ì™€ í•¨ê»˜ "ì§€ë¬¸ê³¼ ëª¨ë“  ì—°ê³„ ë¬¸ì œ í•¨ê»˜ ì¬ìƒì„±" ì²´í¬ë°•ìŠ¤(ë˜ëŠ” ë²„íŠ¼)ë¥¼ ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ì—¬, ì‹œë‚˜ë¦¬ì˜¤ 3ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ìœ ë„í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ `keep_passage`ë¥¼ `false`ë¡œ, `regenerate_related_questions`ë¥¼ `true`ë¡œ ì„¤ì •í•˜ì—¬ APIë¥¼ í˜¸ì¶œí•˜ë„ë¡ êµ¬í˜„í•©ë‹ˆë‹¤.
- **ë¡œë”© ì²˜ë¦¬**: ë™ì‹œ ì¬ìƒì„±ì€ ì—¬ëŸ¬ ë¬¸ì œë¥¼ ìƒì„±í•˜ë¯€ë¡œ ì¼ë°˜ ì¬ìƒì„±ë³´ë‹¤ ì‹œê°„ì´ ë” ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. API í˜¸ì¶œ ì‹œ "ì—°ê´€ëœ ë¬¸ì œë“¤ì„ í•¨ê»˜ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤..."ì™€ ê°™ì€ ìƒì„¸í•œ ë¡œë”© ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
